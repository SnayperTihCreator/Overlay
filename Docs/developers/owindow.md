# Разработка окон [*OWindow*]

[Главная](../README.md) | [Индекс](index.md)

## Описание

Для создания плагина окна в файле `__init__.py` должно быть:

> `CustomOWindow` - это должно быть название вашего класса в стиле CapsCamelCase, импортируемое из одноименного модуля, который лежит в той же папке

```python
def createWindow(parent):
    return CustomOWindow(parent)
```

где `CustomOWindow` - класс-наследник от `OWindow`

## Инициализация создания класса-наследника

Для создания обязательно определённая структура:

```python
from API import OWindow, Config

class CustomOWindow(OWindow):
    def __init__(self, parent=None):
        super().__init__(Config("CustomOWindow", "window", scheme=CustomOWindowConfig), parent)
```

> Название класса и название плагина может не всегда совпадать. Главное, чтобы первый аргумент был такой же, как и папка самого плагина  
> `CustomOWindowConfig` - наследник `ConfigWindow` (который не является наследником `Config` - это два разных класса, которые выполняют разный функционал)

## Создание `config` для предоставления/валидации данных

Все эти классы являются наследниками `pydantic.BaseModel`, поэтому их реализация идет в стиле `pydantic`

```python
from API.defaultConfigs import ConfigWindow

class CustomOWindowConfig(ConfigWindow):
    ...
```

По умолчанию **ВСЕГДА** определены такие свойства:

- window - свойства окна
  - width - горизонтальный размер в пикселях (по умолчанию: 300)
  - height - вертикальный размер в пикселях (по умолчанию: 300)
  - styleFile - имя файла стилей (по умолчанию "style.css")
  - opacity - непрозрачность от 0 до 1 (по умолчанию: 1)
- пользовательские, которые определены и валидируются
- пользовательские, которые не определены (не рекомендуемое поведение и использование)

## Создание `data-config` класса для перезагрузки/сохранения состояния

Все эти классы являются наследниками `pydantic.BaseModel`, поэтому их реализация идет в стиле `pydantic`

```python
from API import WindowConfigData

class CustomDataConfig(WindowConfigData):
    ...
```

После этого его нужно определить в теле класса:

```python
class CustomOWindow(OWindow):
    _config_data_ = CustomDataConfig
    ...
```

после чего он уже используется при сохранении/перезагрузке состояния

По умолчанию **ВСЕГДА** доступные свойства:

- hasMoved - [`int`] возможно ли перетаскивать окно
- notClicked - [`int`] будет ли пропускать окно ввод
- position - [`QPoint`] позиция окна

## Методы, доступные для использования

- `reloadConfig` - метод, который перезагружает конфиг-файл (не рекомендуемый для перегрузки)
- `__save_config__` - метод, который перегружает данные при сохранении состояния. Должен вызывать метод родительского класса и получать его данные состояния, объединяя с пользовательскими. Метод должен возвращать словарь состояний
- `__restore_config__(config)` - метод, который реализует восстановление состояния. Должен вызывать родительский метод, передавая в него сам config. config является экземпляром CustomDataConfig
- `loadConfig` - метод, который вызывается при загрузке конфига. Должен вызывать родительский метод
- `shortcut(key, uname)` - метод, который вызывается при регистрации действия на горячие клавиши (библиотека keyboard) и uname, который является строкой (не рекомендуемый для перегрузки)
- `shortcut_run(uname)` - метод, который вызывается при обработке действия (см. `shortcut`)
- `__ready__` - метод, который вызывается при первой загрузке класса как плагина. Должен вызывать родительский метод
- `__process__` - метод, который вызывается с определенным периодом. Должен вызывать родительский метод
- `createSettingWidget(window: "OWindow", name_plugin: str, parent)` - метод, который должен возвращать экземпляр класса-наследника от `PluginSettingWindow`

## Создание кастомного класса GUI настроек
